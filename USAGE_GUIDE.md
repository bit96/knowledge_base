# 飞书文档自动下载器 v2.0 使用指南

## 新功能特性 ✨

### 快捷键控制
- **双击空格键** - 启动/重启自动化下载操作
- **按ESC键** - 停止自动化下载操作

### 状态显示
- **悬浮框** - 页面左上角实时显示当前状态
- **三种状态** - 准备、启动、停止

## 使用步骤

### 1. 环境准备

#### 安装依赖
```bash
pip3 install -r requirements.txt
```

#### 启动Chrome调试模式
```bash
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222
```

### 2. 登录和导航
1. 在Chrome中登录飞书账号
2. 导航到需要下载的文档列表页面
3. 确保页面完全加载

### 3. 运行程序

#### 方法1: 使用启动脚本（推荐）
```bash
chmod +x start.sh
./start.sh
```

#### 方法2: 直接运行Python脚本
```bash
python3 feishu_downloader.py
```

### 4. 操作流程

1. **启动程序** - 程序启动后会显示准备状态
2. **等待指令** - 观察左上角悬浮框显示"准备"状态
3. **开始下载** - 双击空格键，状态变为"启动"，自动化操作开始
4. **暂停下载** - 按ESC键，状态变为"停止"，自动化操作暂停
5. **继续下载** - 再次双击空格键，可从停止位置继续

## 状态说明

| 状态 | 图标 | 说明 |
|------|------|------|
| 准备 | 🔧 | 脚本已启动，等待用户操作 |
| 启动 | 🚀 | 正在执行自动化下载操作 |
| 停止 | ⏹️ | 自动化操作已停止，可重新启动 |

## 功能特点

### 智能控制
- 全局快捷键监听，无需切换窗口
- 可随时暂停和继续下载过程
- 断点续传支持

### 状态可视化
- 实时状态显示
- 美观的渐变色悬浮框
- 运行状态带有动画效果

### 安全性
- 保持原有的防反爬策略
- 遵守权限边界
- 错误重试机制

## 测试功能

### 快速测试
```bash
python3 test_quick.py
```

### 完整功能测试
```bash
python3 test_hotkey_features.py
```

## 故障排除

### Chrome连接问题
如果提示无法连接Chrome:
1. 确保Chrome调试模式已启动
2. 检查9222端口是否被占用
3. 尝试关闭所有Chrome窗口后重新启动调试模式

### 快捷键无响应
1. 确认程序正在运行
2. macOS可能需要授权辅助功能权限
3. 系统偏好设置 > 安全性与隐私 > 辅助功能 > 添加Python/终端

### 悬浮框不显示
1. 检查Chrome是否正常连接
2. 页面是否支持JavaScript注入
3. 尝试刷新页面后重新启动程序

## 兼容性

- **操作系统**: macOS
- **Python版本**: 3.8+
- **Chrome版本**: 最新版本推荐
- **依赖库**: 已在requirements.txt中列出

## 更新历史

### v2.0 新增功能
- ✅ 全局快捷键控制（双击空格 + ESC）
- ✅ 三状态管理系统（准备/启动/停止）
- ✅ 浏览器页面悬浮状态显示
- ✅ 支持暂停和继续操作
- ✅ 状态可视化和动画效果

### v1.0 原有功能
- ✅ 批量文档下载
- ✅ 智能防反爬策略
- ✅ 断点续传支持
- ✅ 详细日志记录
- ✅ CSV下载记录

## 注意事项

1. **合规使用** - 仅用于有权限访问的文档下载
2. **网络稳定** - 确保网络连接稳定
3. **存储空间** - 预留足够的磁盘空间
4. **权限控制** - 严格遵守飞书的使用条款

---

如有问题或建议，请查看日志文件 `download.log` 或检查控制台输出。